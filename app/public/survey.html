<!doctype html>
<html lang="en">

<head>
  <title>Survey</title>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <script src="https://code.jquery.com/jquery.js"></script>
  <!-- <script src="survey.js"></script> -->

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/css/bootstrap.min.css" integrity="sha384-Smlep5jCw/wG7hdkwQ/Z5nLIefveQRIY9nfy6xoR1uRYBtpZgI6339F5dgvm/e9B"
    crossorigin="anonymous">
  <link rel="stylesheet" href="style.css">

</head>

<body>
  <div class="container">
    <form id="surveyForm">
      <h2>Survey Questions</h2>
      <hr>
      <label for="inputName">Your name (required)</label>
      <input type="text" class="form-control col-md-6" id="inputName" placeholder="Jane Doe" required>

      <label for="imageLink">Link to photo image</label>
      <input type="text" class="form-control col-md-6" id="imageLink" placeholder="URL" required>

      <div id="questionsDiv">
        <!--Questions dynamically generate here-->
      </div>
      <hr>
      <button type="submit" class="btn btn-primary" id="submitSurveyBtn">Submit</button>
    </form>


    <!--Match modal-->
    <div class="modal" id="matchModal" tabindex="-1" role="dialog">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Best matched friend!</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="false">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <p id="matchInfo">
              <!--match name appears here-->
            </p>
            <span id="matchImageSpan">
              <!--match image appears here--></span>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ================================================================= -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/js/bootstrap.min.js" integrity="sha384-o+RDsa0aLu++PJvFqy8fFScvbHFLtbvScb8AjopnFD+iEQ7wo/CG0xlczd+2O/em"
    crossorigin="anonymous"></script>
  <script>
    $(document).ready(function () {
      function writeQuestions() {
        var questions = [
          "1) You would own a house full of cats if possible.",
          "2) You would try a ghost pepper.",
          "3) Good looks are important to you.",
          "4) Family is very important.",
          "5) You love expensive places.",
          "6) You want to get married soon.",
          "7) Brushing your teeth sould be done after every meal.",
          "8) World dominance is important.",
          "9) If you had the chance to shoot hitler when he was a baby you would take it.",
          "10) Apple is better than Android."
        ];

        for (const question of questions) {
          $("#questionsDiv").append(
            $("<div class='row'>").append(
              $("<div class='col-md-12'>").append(
                $("<p>").text(question),
                $("<select class='custom-select custom-select-sm col-md-2'>").append(
                  $("<option selected>Select an option</option>"),
                  $("<option value='1'>1 (Strongly disagree)</option>"),
                  $("<option value='2'>2</option>"),
                  $("<option value='3'>3</option>"),
                  $("<option value='4'>4</option>"),
                  $("<option value='5'>5 (Strongly agree)</option>")
                )
              )
            )
          );
        }
      }

      writeQuestions();

      $("#surveyForm").on("submit", function (event) {
        event.preventDefault();
        const newFriend = {
          name: $("#inputName").val().trim(),
          photo: $("#imageLink").val().trim(),
          scores: $(".custom-select").map(function () {
            return $(this).val();
          }).get()
        };

        $.post("/api/friends", newFriend)
          .then(function (data) {
            $("#matchInfo").text(data.name);
            $("#matchImageSpan").empty().append($("<img>").attr("src", data.photo));
            $("#matchModal").modal("toggle");
          });
      });
    });
  </script>
</body>

</html>